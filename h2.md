**Homework 2**

**A05:2021 – Security Misconfiguration**

- Incorrectly configured permissions, unnecessary ports open, and incorrect privileges, among others, can lead to vulnerable applications.
- The error handling may reveal secrets if incorrect settings are enabled for logging. 
- Several security features are either disabled or not used at all.
- Regular release deployment cycles should harden the system. Using infrastructure as code, the entire process can be automated.
- It is important to conduct server validation tests in order to verify the success of the configuration.

**A06:2021 – Vulnerable and Outdated Components**

- Vulnerable components (OS or software packages, applications, runtime environments) in the client and server-side code.
- Insecure software configuration
- Old/unpatched dependencies in the dependency chain of the components being used.
- Maintain an inventory of components/packages that you are using and ensure that they are kept up-to-date via regular release cycles.
- Reduce attack surfaces by removing unneeded dependencies and components.
- Install packages via trusted channels and make sure to validate their integrity.

**A03:2021 – Injection**

- User input is implicitly trusted, without any sanitization, filtering or escaping.
- Malicious users could control the response generated by the application and maybe even control the servers.
- The happens when data enetered by user get mixed with the interpreter and leads to SQL Injection, Command Injection, Server Side Template Injection, Header Injection, Content Injection (XSS, HTML Injection, CSS Injection).
- Never trust user input since it could leads to disasters. Keep a safelist of characters that can be expected in the input. Reject any input that is malformed or unexpected.

---

**Common Vulnerabilities and Exposures (CVE)**

CVE, short for Common Vulnerabilities and Exposures, is a list of publicly disclosed computer security flaws. When someone refers to a CVE, they mean a security flaw that's been assigned a CVE ID number.

https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44832

https://www.prplbx.com/resources/blog/log4j/

**Apache Log4j Security Vulnerabilities (CVE-2021-44832)**

Apache Log4j is a Java-based logging utility. Log4j Java library’s role is to log information that helps applications run smoothly, determine what’s happening, and help with the debugging process when errors occur.

Apache Log4j2 versions 2.0-beta7 through 2.17.0 (excluding security fix releases 2.3.2 and 2.12.4) are vulnerable to a remote code execution (RCE) attack where an attacker with permission to modify the logging configuration file can construct a malicious configuration using a JDBC Appender with a data source referencing a JNDI URI which can execute remote code.

---

**Episode from Darknet Diaries**


**EP:96 The police station incident**


It was the story of the police officer who was interested in cyber cases, and later secret service enrolled her in their financial and electronic crimes division. The police station in small town was hit with ransomware. it took down the entire network of police dept. Initially, they attempted to mitigate the threat by recovering everything using backups. However, the backups had not been working for the past 10 months. They had to manually restore the system after the ransomware attack, which cost them 10 months of work. In the following week, they were hit again and this time printers stopped working, so the secret service officer arrived at the police station without wasting any time and started investigating.

She got admin credetials from IT admin and started dumping memory and network using volatality. *Volatility* is an open-source free tool which is used in digital forensics.  So, Step One is she’s gotta get into that domain controller which is like the central brain of the network, and take a snapshot of the memory which is what’s in RAM, because whatever data is in memory is what’s being ran right now, and it changes moment to moment.  Now, this can take a while to complete.  You’ve got to sit there waiting for all the memory to be copied over to the USB drive, but it’s more than just whatever memory is active in RAM.  It’s also going to show what processes are running, what apps are open, the names of all the files on the systems, the registry, network connections, users logged in, and system logs.

She fired up *Wireshark* which is a packet-capture tool.  Any traffic coming in and out of this domain server is captured to be analyzed later.  Basically, by capturing all traffic to and from this computer, she’ll be able to capture any malware that’s been sent to it, or malicious commands, or suspicious activity. Working with both volatality and wireshark she was baffled with the fact that multiple admins are logged in on police departmenet server along with her. She started questioning about the pepple who had admin priviligaes and caught one external public IP that was logged in while she was running her scans.

The police station’s domain controller was accessible from the internet over Remote Desktop.  The brains of the network was accessible from anywhere in the world without a VPN.  You just needed the username and password to get into this thing or if you had an exploit for this version of Windows. if you really need someone to get into this remotely, you should probably set up a VPN for admins to connect to first and then get into this.  Having a system running Remote Desktop right on the internet just attracts a ton of people to try to abuse the system. She wrote a search warrant to that ISP asking for who this IP address comes back to. So, what law enforcement can do is issue a search warrant to the ISP to figure out what user was assigned that public IP at the time.

The bitter truth was the connection came from mayor of the city. After questioning mayor and others, she realized that, apparently what him and others were doing were logging into this server through Remote Desktop and then using this computer to log into their webmail to check e-mail.

The network was not set up right.  For whatever reason, someone decided that it was too much of a risk to have the webmail server exposed to the internet for people to log into, but thought it was perfectly fine to have the domain controller exposed to the internet for people to log into instead?  Not only that, but to have them log in as admins, which means they have full permission to change anything they want or do whatever they want in the network?  For instance, with domain admin access, the mayor could easily read anyone’s e-mail, not just his.  He could sabotage users like change their passwords or delete records.  Admins have full control of everything.  The thing is, the domain server is not something the users should ever log into.

Someone sent the mayor a phishing e-mail.  He clicked it; this gave the attacker remote access to his computer.  The attacker put a keystroke logger on the computer and watched what the mayor did.  The mayor went and logged into the police department’s computer to check his e-mail, and the attacker saw all this, including his password he typed.  From there, the attacker logged into the police station, and that’s how the police station got infected with ransomware the first time and almost a second time.



---

**SQL Basics from SQLZoo**

https://sqlzoo.net/wiki/SELECT_basics
```
01 --- show the population of Germany
 
SELECT population FROM world
WHERE name = 'Germany'

02 --- Show the name and the population for 'Sweden', 'Norway' and 'Denmark'.

SELECT name, population FROM world
WHERE name IN ('Sweden', 'Norway', 'Denmark');

03 --- Show the country and the area for countries with an area between 200,000 and 250,000.

SELECT name, area FROM world
WHERE area BETWEEN 200000 AND 250000
```
https://sqlzoo.net/wiki/SELECT_from_WORLD_Tutorial

```

01 --- Observe the result of running this SQL command
to show the name, continent and population of all countries.

SELECT name, continent, population FROM world

02 --- Show the name for the countries that have 
a population of at least 200 million. 

SELECT name FROM world
WHERE population >= 200000000

03 --- Give the name and the per capita GDP for those 
countries with a population of at least 200 million.

SELECT name, gdp/population as Per Capita GDP 
FROM world
WHERE population >= 200000000

04 --- Show the name and population in millions 
for the countries of the continent 'South America'.

SELECT name, population/1000000 as Population/million
FROM world
WHERE continent = 'South America'

05 --- Show the name and population for France, Germany, Italy

SELECT name, population
FROM world
WHERE name IN ('France', 'Germany', 'Italy')

06 --- Show the countries which have a name that includes the word 'United'

SELECT name
FROM world
WHERE name LIKE '%United%'

07 --- Show the countries that are big by area or big by population. Show name, population and area

SELECT name, population, area
FROM world
WHERE population > 250000000 or area > 3000000

08 --- Exclusive OR (XOR). Show the countries that are big by area (more than 3 million) or 
big by population (more than 250 million) but not both. Show name, population and area

SELECT name, population, area
FROM world
WHERE (population > 250000000 and area < 3000000) or (population < 250000000 and area > 3000000)

09 --- Show the name and population in millions and the GDP in billions 
for the countries of the continent 'South America'.

SELECT name, ROUND(population/1000000, 2), ROUND(gdp/1000000000, 2)
FROM world
WHERE continent = 'South America'

10 --- Show the name and per-capita GDP for those countries with a GDP of at least one trillion 1000000000000; 
that is 12 zeros). Round this value to the nearest 1000.

SELECT name, ROUND(gdp/population, -3) as 'Per Capita GDP''
from world
WHERE gdp >= 1000000000000
 
11 ---  Show the name and capital where the name and the capital have the same number of characters

SELECT name, capital
  FROM world
WHERE LEN(name) = LEN(capital)

12 --- Show the name and the capital where the first letters of each match. Don't include countries where the name and the capital are the same word.

SELECT name, capital 
FROM world
WHERE LEFT(name,1) = LEFT(capital,1) AND name <> capital

13 --- Find the country that has all the vowels and no spaces in its name.

SELECT name
   FROM world
WHERE LOWER(name) LIKE '%e%'
  AND LOWER(name) LIKE '%a%'
  AND LOWER(name) LIKE '%i%'
  AND LOWER(name) LIKE '%o%'
  AND LOWER(name) LIKE '%u%'
  AND TRIM(LOWER(name)) NOT LIKE '% %'
```

---


**Webgoat SQL Injection excercises**


![02](https://github.com/ahmad-zeeshan/DataSecurityHW/blob/main/screenshots/02.png)

![03](https://github.com/ahmad-zeeshan/DataSecurityHW/blob/main/screenshots/03.png)

![04](https://github.com/ahmad-zeeshan/DataSecurityHW/blob/main/screenshots/04.png)

![05](https://github.com/ahmad-zeeshan/DataSecurityHW/blob/main/screenshots/05.png)

![examples](https://github.com/ahmad-zeeshan/DataSecurityHW/blob/main/screenshots/examples.png)

![09](https://github.com/ahmad-zeeshan/DataSecurityHW/blob/main/screenshots/09.png)

![10](https://github.com/ahmad-zeeshan/DataSecurityHW/blob/main/screenshots/10.png)

![11](https://github.com/ahmad-zeeshan/DataSecurityHW/blob/main/screenshots/11.png)



